!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("loam",[],r):"object"==typeof exports?exports.loam=r():e.loam=r()}("undefined"!=typeof self?self:this,function(){return function(e){function r(n){if(t[n])return t[n].exports;var u=t[n]={i:n,l:!1,exports:{}};return e[n].call(u.exports,u,u.exports,r),u.l=!0,u.exports}var t={};return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},r.p="",r(r.s=6)}([function(e,r,t){"use strict";function n(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0123456789abcdefghijklmnopqrstuvwxyz",t="",n=e;n>0;n--)t+=r[Math.floor(Math.random()*r.length)];return t}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n,e.exports=r.default},,,function(e,r,t){"use strict";function n(e){var r={PNG:"png",JPEG:"jpg",GTiff:"tif"};if(!e.includes("-of"))return"tif";var t=e[e.indexOf("-of")+1];return Object.keys(r).includes(t)?r[t]:t}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n,e.exports=r.default},,,function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function u(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)}var o=t(7),a=n(o),l=t(8),s=n(l),f=t(9),i=n(f),d=t(10),c=n(d),E=t(11),L=n(E),M=t(12),p=n(M),P=t(13),m=n(P),C=t(14),v=n(C),_=t(15),G=n(_),b=!1,y={},g={CPLErr:{CENone:0,CEDebug:1,CEWarning:2,CEFailure:3,CEFatal:4},CPLErrorReset:null,CPLGetLastErrorMsg:null,CPLGetLastErrorNo:null,CPLGetLastErrorType:null};self.Module={print:function(e){console.log("stdout: "+e)},printErr:function(e){console.log("stderr: "+e)},onRuntimeInitialized:function(){self.Module.ccall("GDALAllRegister",null,[],[]),g.CPLErrorReset=self.Module.cwrap("CPLErrorReset",null,[]),g.CPLGetLastErrorMsg=self.Module.cwrap("CPLGetLastErrorMsg","string",[]),g.CPLGetLastErrorNo=self.Module.cwrap("CPLGetLastErrorNo","number",[]),g.CPLGetLastErrorType=self.Module.cwrap("CPLGetLastErrorType","number",[]);var e=Runtime.addFunction(self.Module.cwrap("CPLQuietErrorHandler","number",["number"]));self.Module.ccall("CPLSetErrorHandler","number",["number"],[e]),y.GDALOpen=(0,a.default)(self.Module.cwrap("GDALOpen","number",["string"]),g,"/datasets"),y.GDALClose=(0,s.default)(self.Module.cwrap("GDALClose","number",["number"]),g),y.GDALGetRasterCount=(0,i.default)(self.Module.cwrap("GDALGetRasterCount","number",["number"]),g),y.GDALGetRasterXSize=(0,c.default)(self.Module.cwrap("GDALGetRasterXSize","number",["number"]),g),y.GDALGetRasterYSize=(0,L.default)(self.Module.cwrap("GDALGetRasterYSize","number",["number"]),g),y.GDALGetProjectionRef=(0,p.default)(self.Module.cwrap("GDALGetProjectionRef","string",["number"]),g),y.GDALGetGeoTransform=(0,m.default)(self.Module.cwrap("GDALGetGeoTransform","number",["number","number"]),g),y.GDALTranslate=(0,v.default)(self.Module.cwrap("GDALTranslate","number",["string","number","number","number"]),g,"/datasets"),y.GDALWarp=(0,G.default)(self.Module.cwrap("GDALWarp","number",["string","number","number","number","number","number"]),g,"/datasets"),y.LoamFlushFS=function(){var e=FS.lookupPath("/datasets").node.contents;return Object.values(e).forEach(function(e){FS.unmount(FS.getPath(e)),FS.rmdir(FS.getPath(e))}),!0},FS.mkdir("/datasets"),b=!0,postMessage({ready:!0})}},importScripts("gdal.js"),onmessage=function(e){if(!b)return void postMessage({success:!1,message:"Runtime not yet initialized"});if(e.data.function&&y[e.data.function]){var r=y[e.data.function],t=e.data.arguments;try{var n=r.apply(void 0,u(t));postMessage({success:!0,result:n,id:e.data.id})}catch(r){postMessage({success:!1,message:r.message,id:e.data.id})}}else postMessage({success:!1,message:'No "function" key specified or function not found',id:e.data.id})}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,r,t){return function(n){var o=void 0,a=t+"/"+(0,u.default)();FS.mkdir(a),n instanceof File?(o=n.name,FS.mount(WORKERFS,{files:[n]},a)):n instanceof Blob&&(o="geotiff.tif",FS.mount(WORKERFS,{blobs:[{name:o,data:n}]},a));var l=a+"/"+o,s=e(l),f=r.CPLGetLastErrorType();if(f===r.CPLErr.CEFailure||f===r.CPLErr.CEFatal){FS.unmount(a),FS.rmdir(a);var i=r.CPLGetLastErrorMsg();throw new Error(i)}return{datasetPtr:s,filePath:l,directory:a,filename:o}}};var n=t(0),u=function(e){return e&&e.__esModule?e:{default:e}}(n);e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,r){return function(t,n,u){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e(t);var a=[];o&&(a=FS.readFile(u,{encoding:"binary"})),FS.unmount(n),FS.rmdir(n);var l=r.CPLGetLastErrorType();if(l===r.CPLErr.CEFailure||l===r.CPLErr.CEFatal){var s=r.CPLGetLastErrorMsg();throw new Error(s)}return a}},e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,r){return function(t){var n=e(t),u=r.CPLGetLastErrorType();if(u===r.CPLErr.CEFailure||u===r.CPLErr.CEFatal){var o=r.CPLGetLastErrorMsg();throw new Error(o)}return n}},e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,r){return function(t){var n=e(t),u=r.CPLGetLastErrorType();if(u===r.CPLErr.CEFailure||u===r.CPLErr.CEFatal){var o=r.CPLGetLastErrorMsg();throw new Error(o)}return n}},e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,r){return function(t){var n=e(t),u=r.CPLGetLastErrorType();if(u===r.CPLErr.CEFailure||u===r.CPLErr.CEFatal){var o=r.CPLGetLastErrorMsg();throw Error(o)}return n}},e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,r){return function(t){var n=e(t),u=r.CPLGetLastErrorType();if(u===r.CPLErr.CEFailure||u===r.CPLErr.CEFatal){var o=r.CPLGetLastErrorMsg();throw new Error(o)}return n}},e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,r){return function(t){var n=Module._malloc(6*Float64Array.BYTES_PER_ELEMENT);e(t,n);var u=Module.HEAPF64.subarray(n/Float64Array.BYTES_PER_ELEMENT,n/Float64Array.BYTES_PER_ELEMENT+6),o=r.CPLGetLastErrorType();if(o===r.CPLErr.CEFailure||o===r.CPLErr.CEFatal){Module._free(n);var a=r.CPLGetLastErrorMsg();throw new Error(a)}var l=Array.from(u);return Module._free(n),l}},e.exports=r.default},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,r,t){return function(n,u){function a(){Module.ccall("GDALTranslateOptionsFree",null,["number"],[i]),Module._free(f),Module._free(p),s.subarray(0,s.length-1).forEach(function(e){return Module._free(e)})}var s=Uint32Array.from(u.map(function(e){return Module._malloc(Module.lengthBytesUTF8(e)+1)}).concat([0]));u.forEach(function(e,r){Module.stringToUTF8(e,s[r],Module.lengthBytesUTF8(e)+1)});var f=Module._malloc(s.length*s.BYTES_PER_ELEMENT);Module.HEAPU32.set(s,f/s.BYTES_PER_ELEMENT);var i=Module.ccall("GDALTranslateOptionsNew","number",["number","number"],[f,null]),d=r.CPLGetLastErrorType();if(d===r.CPLErr.CEFailure||d===r.CPLErr.CEFatal){Module._free(f),s.subarray(0,s.length-1).forEach(function(e){return Module._free(e)});var c=r.CPLGetLastErrorMsg();throw new Error(c)}var E=t+"/"+(0,o.default)();FS.mkdir(E),FS.mount(MEMFS,{},E);var L=(0,o.default)(8)+"."+(0,l.default)(u),M=E+"/"+L,p=Module._malloc(Int32Array.BYTES_PER_ELEMENT);Module.setValue(p,0,"i32");var P=e(M,n,i,p),m=r.CPLGetLastErrorType();if(m===r.CPLErr.CEFailure||m===r.CPLErr.CEFatal){a();var C=r.CPLGetLastErrorMsg();throw new Error(C)}var v={datasetPtr:P,filePath:M,directory:E,filename:L};return a(),v}};var u=t(0),o=n(u),a=t(3),l=n(a);e.exports=r.default},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,r,t){return function(n,u){function a(){Module.ccall("GDALWarpAppOptionsFree",null,["number"],[i]),Module._free(f),Module._free(p),s.subarray(0,s.length-1).forEach(function(e){return Module._free(e)})}var s=Uint32Array.from(u.map(function(e){return Module._malloc(Module.lengthBytesUTF8(e)+1)}).concat([0]));u.forEach(function(e,r){Module.stringToUTF8(e,s[r],Module.lengthBytesUTF8(e)+1)});var f=Module._malloc(s.length*s.BYTES_PER_ELEMENT);Module.HEAPU32.set(s,f/s.BYTES_PER_ELEMENT);var i=Module.ccall("GDALWarpAppOptionsNew","number",["number","number"],[f,null]),d=r.CPLGetLastErrorType();if(d===r.CPLErr.CEFailure||d===r.CPLErr.CEFatal){Module._free(f),s.subarray(0,s.length-1).forEach(function(e){return Module._free(e)});var c=r.CPLGetLastErrorMsg();throw new Error(c)}var E=t+"/"+(0,o.default)();FS.mkdir(E),FS.mount(MEMFS,{},E);var L=(0,o.default)(8)+"."+(0,l.default)(u),M=E+"/"+L,p=Module._malloc(Int32Array.BYTES_PER_ELEMENT);Module.setValue(p,0,"i32");var P=Module._malloc(4);Module.setValue(P,n,"*");var m=e(M,0,1,P,i,p),C=r.CPLGetLastErrorType();if(C===r.CPLErr.CEFailure||C===r.CPLErr.CEFatal){a();var v=r.CPLGetLastErrorMsg();throw new Error(v)}var _={datasetPtr:m,filePath:M,directory:E,filename:L};return a(),_}};var u=t(0),o=n(u),a=t(3),l=n(a);e.exports=r.default}])});